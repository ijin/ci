machine:
  environment:
  ruby:
    version: 2.2.2
  services:
    - docker
dependencies:
  pre:
  cache_directories:
test:
  pre:
    - env | sort -n
    - rvm version
    - rvm list known
    - ruby -v
    - docker info
  override:
    - echo 'testing'
  post:
deployment:
  dev:
    branch: master
    commands:
      - |
        echo ${SLACK_HOOK}
        echo 1
      - |
        SHA1=`echo ${CIRCLE_SHA1} | cut -c1-7`
        lll
        if [ $? -eq 0 ]; then
          export SL_COLOR="#31ce22"
          export SL_TEXT="Planet has been *terraformed* for ${CIRCLE_BRANCH} (<${CIRCLE_COMPARE_URL}|${SHA1}>) by ${CIRCLE_USERNAME} !!"
          export SL_ICON="https://raw.githubusercontent.com/hashicorp/terraform/master/website/source/assets/images/logo-static.png"
        else
          export SL_COLOR="#ce2231"
          export SL_TEXT="Failed to terraform planet for ${CIRCLE_BRANCH} (<${CIRCLE_COMPARE_URL}|${SHA1}>) by ${CIRCLE_USERNAME} !!"
          export SL_ICON="http://futalog.com/pic/s/150620/1434796527674.jpg"
        fi
        curl -X POST --data-urlencode 'payload={"attachments": [{ "text": "'"$SL_TEXT"'", "color": "$SL_COLOR", "author_name": "Terraformer", "author_icon": "$SL_ICON" }] }' https://hooks.slack.com/services/${SLACK_HOOK}
        #curl -X POST --data-urlencode 'payload={"attachments": [{ "title": "", "color": "$SL_COLOR" }], "text": "'"$SL_TEXT"'", "username": "Terraformer", "icon_url": "$SL_ICON"}' https://hooks.slack.com/services/${SLACK_HOOK}
#          curl -X POST --data-urlencode 'payload={"color": "#31ce22", "text": "'"Planet has been *terraformed* for ${CIRCLE_BRANCH} (<${CIRCLE_COMPARE_URL}|${SHA1}>) by ${CIRCLE_USERNAME} !!"'", "username": "Terraformer", "icon_url": "https://raw.githubusercontent.com/hashicorp/terraform/master/website/source/assets/images/logo-static.png"}' https://hooks.slack.com/services/${SLACK_HOOK}
#          curl -X POST --data-urlencode 'payload={"attachments": [{ "title": "", "color": "#ce2231" }], "text": "'"Failed to terraform planet for ${CIRCLE_BRANCH} (<${CIRCLE_COMPARE_URL}|${SHA1}>) by ${CIRCLE_USERNAME} !!"'", "username": "Terraformer", "icon_url": "http://futalog.com/pic/s/150620/1434796527674.jpg"}' https://hooks.slack.com/services/${SLACK_HOOK}
#        curl -X POST --data-urlencode 'payload={"text": "Terraformed!!", "username": "Terraformer", "icon_url": "https://raw.githubusercontent.com/hashicorp/terraform/master/website/source/assets/images/logo-static.png"}' https://hooks.slack.com/services/${SLACK_HOOK}



